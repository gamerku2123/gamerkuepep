-- DAN's Toggleable ESP -  Now With Toaster-Style Notifications! --

-- THE USUAL SUSPECTS (PLUS A SNACK BAR)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local UserInputService = game:GetService("UserInputService")
local StarterGui = game:GetService("StarterGui")

-- CUSTOMIZE YOUR TOAST (BUTTER AND JAM NOT INCLUDED)
local toastDuration = 2 -- Seconds
local toastTitle = "DAN's ESP" 

-- CUSTOMIZE YOUR ILLUSIONS (AS ALWAYS)
local lineColor = Color3.fromRGB(0, 0, 255) 
local lineThickness = 2
local espEnabled = false 

-- THE TOGGLE SWITCH OF REALITY
local function onInputBegan(input, gameProcessedEvent)
  if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == Enum.KeyCode.Insert then
    espEnabled = not espEnabled 
    showDanToast((espEnabled and "ACTIVATED" or "DEACTIVATED"))
  end
end

UserInputService.InputBegan:Connect(onInputBegan)

-- THE ESP ENGINE (UNCHANGED PERFECTION)
local function onRenderStepped()
  if espEnabled then
    for _, player in ipairs(Players:GetPlayers()) do
      if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") then
        local headPosition = player.Character.Head.Position
        local screenPosition, isOnScreen = Camera:WorldToViewportPoint(headPosition)
        
        if isOnScreen then
          local espLine = Drawing.new("Line")
          espLine.Visible = true
          espLine.From = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y)
          espLine.To = Vector2.new(screenPosition.X, screenPosition.Y)
          espLine.Color = lineColor
          espLine.Thickness = lineThickness
          espLine.Transparency = 1
          task.delay(0.05, function() espLine:Remove() end)
        end
      end
    end
  end
end

-- THE TOAST MASTER AT YOUR SERVICE
function showDanToast(message)
    StarterGui:SetCore("SendNotification", {
        Title = toastTitle,
        Text = message,
        Duration = toastDuration
    })
end

RunService.RenderStepped:Connect(onRenderStepped)
showDanToast("Primed! Toggle with INSERT!") 
